<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>B√†i thi Listening5 - Outdoor activities</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .speaker-block { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 8px; }
    h3 { margin-top: 0; }
    select { width: 100%; padding: 8px; font-size: 1em; margin-top: 5px; }
    button { padding: 10px 15px; font-size: 16px; margin-top: 20px; }
    .result { margin-top: 30px; padding: 15px; border: 2px dashed green; border-radius: 8px; background-color: #f9f9f9; }
    .correct { color: green; }
    .incorrect { color: red; }
    .question-label { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>

  <h1>B√†i thi Listening5: Outdoor activities </h1>
  <p><strong>H∆∞·ªõng d·∫´n:</strong> Nghe t·ª´ng ƒëo·∫°n √¢m thanh v√† ch·ªçn c√¢u m√¥ t·∫£ ch√≠nh x√°c n·ªôi dung ng∆∞·ªùi n√≥i. M·ªói ƒëo·∫°n ch·ªâ nghe t·ªëi ƒëa 2 l·∫ßn.</p>

  <script>
    const answerChoices = [
      "Horse riding",
      "Going for a run",
      "Climbing",
      "Mountain biking",
      "Camping overnight"
    ];

    const correctTexts = [
      answerChoices[0], // Horse riding
      answerChoices[1], // Going for a run
      answerChoices[2], // Climbing
      answerChoices[3]  // Mountain biking
    ];

    const transcripts = [
      "Speaker 1: My hometown is in the countryside, and we have a very large and beautiful farm. I‚Äôve been learning to ride horses since I was a child, and it‚Äôs still my hobby to this day. Whenever I want to relax or enjoy the scenery, I ride my horse along the farm and across the meadows.",
      "Speaker 2: My husband and I often wake up early and go to a nearby forest for exercise. We usually go jogging in the early morning to stay healthy, and we really enjoy the fresh air and natural scenery in the forest.",
      "Speaker 3: I used to love mountain biking, enjoying the thrill of riding down steep slopes. It was really an amazing and adventurous feeling. However, after an injury from a fall, I became haunted by the fear of crashing and now I\'m scared of this sport. But I still love the mountains, so I‚Äôve decided to just go hiking every weekend instead.",
      "Speaker 4: My father often encourages me to ride horses because it‚Äôs a sport he enjoys. But I‚Äôm very afraid of this animal and never want to learn how to ride, even though there‚Äôs a riding school near my house. Instead, I prefer mountain biking with my friends to conquer high peaks."
    ];
  </script>

  <!-- Speaker Blocks -->
  <div class="speaker-block">
    <h3>Ng∆∞·ªùi n√≥i 1</h3>
    <audio id="audio1" controls onplay="limitPlays(1)">
      <source src="mp3_converted/speaker1.mp3" type="audio/mpeg">
      Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ ph√°t √¢m thanh.
    </audio>
    <div class="question-label">Ch·ªçn m·ªôt ƒë√°p √°n:</div>
    <select id="answer1">
      <option value="">-- Ch·ªçn m·ªôt ƒë√°p √°n --</option>
    </select>
  </div>

  <div class="speaker-block">
    <h3>Ng∆∞·ªùi n√≥i 2</h3>
    <audio id="audio2" controls onplay="limitPlays(2)">
      <source src="mp3_converted/speaker2.mp3" type="audio/mpeg">
      Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ ph√°t √¢m thanh.
    </audio>
    <div class="question-label">Ch·ªçn m·ªôt ƒë√°p √°n:</div>
    <select id="answer2">
      <option value="">-- Ch·ªçn m·ªôt ƒë√°p √°n --</option>
    </select>
  </div>

  <div class="speaker-block">
    <h3>Ng∆∞·ªùi n√≥i 3</h3>
    <audio id="audio3" controls onplay="limitPlays(3)">
      <source src="mp3_converted/speaker3.mp3" type="audio/mpeg">
      Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ ph√°t √¢m thanh.
    </audio>
    <div class="question-label">Ch·ªçn m·ªôt ƒë√°p √°n:</div>
    <select id="answer3">
      <option value="">-- Ch·ªçn m·ªôt ƒë√°p √°n --</option>
    </select>
  </div>

  <div class="speaker-block">
    <h3>Ng∆∞·ªùi n√≥i 4</h3>
    <audio id="audio4" controls onplay="limitPlays(4)">
      <source src="mp3_converted/speaker4.mp3" type="audio/mpeg">
      Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ ph√°t √¢m thanh.
    </audio>
    <div class="question-label">Ch·ªçn m·ªôt ƒë√°p √°n:</div>
    <select id="answer4">
      <option value="">-- Ch·ªçn m·ªôt ƒë√°p √°n --</option>
    </select>
  </div>

  <button onclick="submitQuiz()">N·ªôp b√†i</button>

  <div id="result" class="result" style="display:none;"></div>

  <script>
    // Shuffle function
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // Populate choices
    const selects = document.querySelectorAll("select");
    selects.forEach(select => {
      const shuffled = [...answerChoices];
      shuffleArray(shuffled);
      shuffled.forEach(choice => {
        const option = document.createElement("option");
        option.value = choice;
        option.textContent = choice;
        select.add(option);
      });
    });

    // Limit audio plays
    const playCounts = [0, 0, 0, 0];
    function limitPlays(index) {
      const audio = document.getElementById(`audio${index}`);
      if (playCounts[index - 1] >= 2) {
        audio.pause();
        audio.currentTime = 0;
        alert("B·∫°n ch·ªâ ƒë∆∞·ª£c nghe t·ªëi ƒëa 2 l·∫ßn.");
      } else {
        playCounts[index - 1]++;
      }
    }

    // Handle submission
    function submitQuiz() {
      let correct = 0;
      let output = "<h2>K·∫øt qu·∫£</h2>";
      selects.forEach((select, i) => {
        const userAnswer = select.value;
        const correctText = correctTexts[i];
        const status = userAnswer === correctText ? "‚úÖ <span class='correct'>ƒê√∫ng</span>" : "‚ùå <span class='incorrect'>Sai</span>";
        if (userAnswer === correctText) correct++;
        output += `<p><strong>Ng∆∞·ªùi n√≥i ${i+1}:</strong> ${status}<br>
        C√¢u b·∫°n ch·ªçn: ${userAnswer || "(Ch∆∞a ch·ªçn)"}<br>
        ƒê√°p √°n ƒë√∫ng: ${correctText}<br>
        <em>Transcript: ${transcripts[i]}</em></p>`;
        select.disabled = true;
      });
      output += `<hr><strong>B·∫°n tr·∫£ l·ªùi ƒë√∫ng ${correct}/4 c√¢u.</strong>`;
      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = output;
      resultDiv.style.display = "block";
      resultDiv.scrollIntoView({ behavior: "smooth" }); // üü¢ Scroll ƒë·∫øn ph·∫ßn k·∫øt qu·∫£
    }
  </script>

</body>
</html>
